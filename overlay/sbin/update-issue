#!/bin/sh
# Generate /etc/issue with colorful MaculaOS banner
# Font: standard

. /etc/os-release

ESC=$(printf '\033')
CYAN="${ESC}[1;36m"
WHITE="${ESC}[1;37m"
ORANGE="${ESC}[1;33m"
GRAY="${ESC}[0;37m"
RESET="${ESC}[0m"

cat > /etc/issue << BANNER

${CYAN}    .o---o.${RESET}
${CYAN}   /|     |\\${RESET}       ${ORANGE} __  __    _    ____ _   _ _        _        ___  ____  ${RESET}
${CYAN}  o-+-----+-o${RESET}     ${ORANGE}|  \/  |  / \  / ___| | | | |      / \      / _ \/ ___| ${RESET}
${CYAN}   \\|     |/${RESET}      ${ORANGE}| |\/| | / _ \| |   | | | | |     / _ \    | | | \___ \ ${RESET}
${CYAN}    'o---o'${RESET}       ${ORANGE}| |  | |/ ___ \ |___| |_| | |___ / ___ \   | |_| |___) |${RESET}
${CYAN}      \\ /${RESET}         ${ORANGE}|_|  |_/_/   \_\____|\___/|_____/_/   \_\   \___/|____/ ${RESET}
${CYAN}       o${RESET}
                  ${WHITE}Decentralized Edge Computing Platform${RESET}

${GRAY}  $PRETTY_NAME - Kernel \r on \m (\l)${RESET}

BANNER

NICS=$(ip -br addr show 2>/dev/null | grep -E -v '^(lo|flannel|cni|veth|docker|br-)' | head -3)
if [ -n "$NICS" ]; then
    printf '%s  Network:%s\n' "$CYAN" "$RESET" >> /etc/issue
    printf '%s%s%s\n\n' "$GRAY" "$NICS" "$RESET" >> /etc/issue
fi

printf '%s  Login: %smacula%s / %smacula%s\n\n' "$WHITE" "$ORANGE" "$WHITE" "$ORANGE" "$RESET" >> /etc/issue
