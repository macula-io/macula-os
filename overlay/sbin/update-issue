#!/bin/sh
# Generate /etc/issue with colorful MaculaOS banner

. /etc/os-release

# ANSI escape sequences
ESC=$(printf '\033')
CYAN="${ESC}[1;36m"
WHITE="${ESC}[1;37m"
ORANGE="${ESC}[1;33m"
GRAY="${ESC}[0;37m"
RESET="${ESC}[0m"

# Write banner with ASCII art title
cat > /etc/issue << BANNER

${CYAN}    .o---o.
   /|     |\\${RESET}      ${ORANGE}╔╦╗╔═╗╔═╗╦ ╦╦  ╔═╗  ╔═╗╔═╗${RESET}
${CYAN}  o-+-----+-o${RESET}     ${ORANGE}║║║╠═╣║  ║ ║║  ╠═╣  ║ ║╚═╗${RESET}
${CYAN}   \\|     |/${RESET}      ${ORANGE}╩ ╩╩ ╩╚═╝╚═╝╩═╝╩ ╩  ╚═╝╚═╝${RESET}
${CYAN}    'o---o'${RESET}
${CYAN}      \\ /${RESET}         ${WHITE}Decentralized Edge Computing${RESET}
${CYAN}       o${RESET}

${GRAY}  $PRETTY_NAME - Kernel \r on \m (\l)${RESET}

BANNER

# Network interfaces
NICS=$(ip -br addr show 2>/dev/null | grep -E -v '^(lo|flannel|cni|veth|docker|br-)' | head -3)
if [ -n "$NICS" ]; then
    printf '%s  Network:%s\n' "$CYAN" "$RESET" >> /etc/issue
    printf '%s%s%s\n\n' "$GRAY" "$NICS" "$RESET" >> /etc/issue
fi

# Login prompt
printf '%s  Login: %smacula%s / %smacula%s\n\n' "$WHITE" "$ORANGE" "$WHITE" "$ORANGE" "$RESET" >> /etc/issue
